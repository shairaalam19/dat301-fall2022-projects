---
title: "DAT301 Midterm Project"
author: "Amber Kahklen 1216918261, Shaira Alam, Alyssa Stefencavage"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
df = read.csv("adultdata.csv") #you will have to change this to your directory when working on it
colnames(df) <-c("age", "workclass", "fnlwgt", "education", "education-num", "marital-Status", "occupation", "relationship", "race", "sex", "capital-gain", "capital-loss", "hours-per-week", "native-country", "wage_below_orAbove_50k")
library(ggplot2movies)
library(dplyr)
library(ggplot2)
adultData <- data.frame(df)
```
## Income Prediction | Based on Census Data

UCI's Machine Learning Repository, Adult Data Set: https://archive.ics.uci.edu/ml/datasets/Adult

- Predicts if income is above or below $50,000 based on census data.
- Extraction was done by Barry Becker taken from 1994 Census database

```{r,out.width='350px',out.height='225px',echo=FALSE,fig.align='center'}

knitr::include_graphics('./male-female-money.png')
```

## Categories of Adult Income Data

<font size = "3">**age**: continuous.

**workclass**: Private, Self-emp-not-inc, Self-emp-inc, Federal-gov, Local-gov, State-gov,    Without-pay, Never-worked.
            
**fnlwgt**: continuous.

**education**: Bachelors, Some-college, 11th, HS-grad, Prof-school, Assoc-acdm, Assoc-voc, 9th, 
            7th-8th, 12th, Masters, 1st-4th, 10th, Doctorate, 5th-6th, Preschool.
            
**education-num**: continuous.

**marital-status**: Married-civ-spouse, Divorced, Never-married, Separated, Widowed, 
                Married-spouse-absent, Married-AF-spouse.
                
**occupation**: Tech-support, Craft-repair, Other-service, Sales, Exec-managerial, Prof-specialty, 
            Handlers-cleaners, Machine-op-inspct, Adm-clerical, Farming-fishing, Transport-moving,             Priv-house-serv, Protective-serv, Armed-Forces.
            
**relationship**: Wife, Own-child, Husband, Not-in-family, Other-relative, Unmarried.

**race**: White, Asian-Pac-Islander, Amer-Indian-Eskimo, Other, Black.

**sex**: Female, Male.</font>

## Categories of Adult Income Data Continued

<font size = "3">

**capital-gain**: continuous

**capital-loss**: continuous

**hours-per-week**: continuous.

**native-country**: United-States, Cambodia, England, Puerto-Rico, Canada, Germany, 
                  Outlying-US(Guam-USVI-etc), India, Japan, Greece, South, China, Cuba, Iran,                       Honduras, Philippines, Italy, Poland, Jamaica, Vietnam, Mexico, Portugal,                         Ireland, France, Dominican-Republic, Laos, Ecuador, Taiwan, Haiti, Columbia,                      Hungary, Guatemala, Nicaragua, Scotland, Thailand, Yugoslavia, El-Salvador,                       Trinadad&Tobago, Peru, Hong, Holand-Netherlands.</font>

## Attribute Details

**fnlwgt**: 

The number of people one row represents

**marital-status**: 

Married-civ-spouse: Married to a civilian

Married-AF-spouse: Married to someone in the Armed Forces


## Motivation

Help us in our own careers.

See historically what attributes people have to increase wage.
```{r,out.width='300px',out.height='170px',echo=FALSE,fig.align='left'}

knitr::include_graphics('./grad.png')
```
```{r,out.width='300px',out.height='200px',echo=FALSE,fig.align='right'}

knitr::include_graphics('./family.png')
```

## Challenges

Different characters in the name:
Married-civ-spouse has a space in the front

Some values are missing in rows

## 1. Plot the count for each education level.  

```{r}
education  <- adultData %>% count(education)
Levels <- c("Bachelors", "Some-college", "11th", "HS-grad", "Prof-school", "Assoc-acdm", "Assoc-voc", "9th", 
            "7th-8th", "12th", "Masters", "1st-4th", "10th", "Doctorate", "5th-6th", "Preschool")
Count <- c(education$n)
education <- data.frame(education)
p <- ggplot(education, aes(x=Levels, y=Count, fill=Levels)) + 
geom_bar(stat="identity")
p + theme(axis.text.x = element_text(angle = 90))
```

## 2. Does the workclass affect if the individual make above or below 50k a year

```{r}
class <- adultData %>% count(workclass)

Classes <- c("Private", "Self-emp-not-inc", "Self-emp-inc", "Federal-gov", "Local-gov", "State-gov","Without-pay", "Never-worked")
Count <- c(class$n)

# DOES NOT WORK 
# class <- data.frame(class)
# ggplot(class, aes(x=Classes, y=Count, fill=Classes)) + 
# geom_bar(stat="identity")
```

## 3. Hours per Week | Wage above or below 50k a year?

On Average, people that work over 40 hours a week have wages >50k

```{r,fig.height=4}
Hours <- adultData$hours.per.week
boxplot(Hours~adultData$wage_below_orAbove_50k,horizontal=TRUE, col=c("green", "blue"), main="Hours Per Week based on Wage", xlab = "Hours Worked per Week", ylab = "Wage")
legend("topright", legend = c("Wage is Below 50k", "Wage is Above 50K"), fill = c("green", "blue"))

```
```{r}
# REPEAT 
#boxplot(df$`hours-per-week`~df$`wage_below_orAbove_50k`, main = "Hours Per Week vs. Wage", xlab = "Wage", ylab = "Hours Worked per Week", col = #c("cornflowerblue", "darkolivegreen3"))
#legend("topright", legend = c("Wage is Below 50k", "Wage is Above 50K"), fill = c("cornflowerblue", "darkolivegreen3"))
```

## 4. Marital Status | Does making above or below 50k have an impact on marital status?

```{r}
mcsg = length(df$`marital-Status`[df$`marital-Status` == " Married-civ-spouse" & 
                             df$wage_below_orAbove_50k == " >50K"])
mcsl = length(df$`marital-Status`[df$`marital-Status` == " Married-civ-spouse" & 
                             df$wage_below_orAbove_50k == " <=50K"])
divg = length(df$`marital-Status`[df$`marital-Status` == " Divorced" & 
                             df$wage_below_orAbove_50k == " >50K"])
divl = length(df$`marital-Status`[df$`marital-Status` == " Divorced" & 
                             df$wage_below_orAbove_50k == " <=50K"])
nmg = length(df$`marital-Status`[df$`marital-Status` == " Never-married"& 
                             df$wage_below_orAbove_50k == " >50K"])
nml = length(df$`marital-Status`[df$`marital-Status` == " Never-married"& 
                             df$wage_below_orAbove_50k == " <=50K"])
sepg = length(df$`marital-Status`[df$`marital-Status` == " Separated"& 
                             df$wage_below_orAbove_50k == " >50K"])
sepl = length(df$`marital-Status`[df$`marital-Status` == " Separated"& 
                             df$wage_below_orAbove_50k == " <=50K"])
widg = length(df$`marital-Status`[df$`marital-Status` == " Widowed"& 
                             df$wage_below_orAbove_50k == " >50K"])
widl = length(df$`marital-Status`[df$`marital-Status` == " Widowed"& 
                             df$wage_below_orAbove_50k == " <=50K"])
msag = length(df$`marital-Status`[df$`marital-Status` == " Married-spouse-absent"& 
                             df$wage_below_orAbove_50k == " >50K"])
msal = length(df$`marital-Status`[df$`marital-Status` == " Married-spouse-absent"& 
                             df$wage_below_orAbove_50k == " <=50K"])
masg = length(df$`marital-Status`[df$`marital-Status` == " Married-AF-spouse"& 
                             df$wage_below_orAbove_50k == " >50K"])
masl = length(df$`marital-Status`[df$`marital-Status` == " Married-AF-spouse"& 
                             df$wage_below_orAbove_50k == " <=50K"])

m_s <- as.table(rbind(c(mcsg, divg, nmg, sepg, widg, msag, masg), c(mcsl, divl, nml, sepl, widl, msal, masl)))
dimnames(m_s) <- list(Wage = c(">50K", "<=50K"), Marital_Status = c("Married, Civilian Spouse", "Divorced", "Never Married", "Separated", "Widowed", "Married, Spouse Absent", "Married, Armed Forces Spouse"))
library(knitr)

kable(m_s)

```
Analysis:

There largest group of people that make over 50k are married.

The largest group of people that make under 50k have never been married.

## Barplot for Question 4

```{r}
par(mar = c(8, 4, 1, 1))
yy <- barplot(m_s, ylim = c(0, 17000), main = "Wage per Marital Status", xlab = " ", ylab = "# of people", col = c("blue", "pink"), names.arg = c("Married,\n Civilian Spouse", "Divorced", "Never Married", "Separated", "Widowed", "Married,\n Spouse Absent", "Married, Armed\n Forces Spouse"), las = 3, beside=TRUE)
mtext("Marital Status", side=1, line = 6)
legend("topright", legend = c("Wage is Below 50k", "Wage is Above 50K"), fill = c("blue", "pink"))
text(x = yy, y = m_s+700, label=as.character(m_s))
```

## 5. Gender | Does gender have an effect on wages?

```{r}
wageWomenG = length(df$sex[df$sex == " Female" & df$wage_below_orAbove_50k == " >50K"])
wageWomenL = length(df$sex[df$sex == " Female" & df$wage_below_orAbove_50k == " <=50K"])
wageMenG = length(df$sex[df$sex == " Male" & df$wage_below_orAbove_50k == " >50K"])
wageMenL = length(df$sex[df$sex == " Male" & df$wage_below_orAbove_50k == " <=50K"])

wageMvW <- as.table(rbind(c(wageWomenG, wageMenG), c(wageWomenL, wageMenL)))
dimnames(wageMvW) <- list(Wage = c(">50K", "<=50K"), Sex = c("Female", "Men"))

zz <- barplot(wageMvW, main = "Wage based on Gender", xlab = "Gender", ylab = "Number of People", ylim = c(0, 25000), beside = TRUE, col = c("blue", "pink"))
text(x = zz, y = wageMvW+1000, label=as.character(wageMvW))
legend("topright", legend = c("Wage is Above 50K", "Wage is Below 50k"), fill = c("blue", "pink"))

```

## 6. Hours per Week | Does the hours per week affect marital status?

```{r,fig.height=4}
mcs = df$`hours-per-week`[df$`marital-Status` == " Married-civ-spouse"]
div = df$`hours-per-week`[df$`marital-Status` == " Divorced"]
nm = df$`hours-per-week`[df$`marital-Status` == " Never-married"]
sep = df$`hours-per-week`[df$`marital-Status` == " Separated"]
wid = df$`hours-per-week`[df$`marital-Status` == " Widowed"]
msa = df$`hours-per-week`[df$`marital-Status` == " Married-spouse-absent"]
mas = df$`hours-per-week`[df$`marital-Status` == " Married-AF-spouse"]

hoursPerRelStatus = c(mean(mcs), mean(div), mean(nm), mean(sep), mean(wid), mean(msa), mean(mas))
hoursPerRelStatusR = round(hoursPerRelStatus, digits = 2)

par(mar = c(8, 4, 5, 1))
xx <- barplot(hoursPerRelStatus, main = "Average Hours Worked per Week by Marital Status", xlab = "", ylab = "Hours Worked in a Week", ylim = c(0, 50), names.arg = c("Married,\n Civilian Spouse", "Divorced", "Never Married", "Separated", "Widowed", "Married,\n Spouse Absent", "Married, Armed\n Forces Spouse"), las = 2, col = c("green", "red", "blue", "Pink", "Purple", "Yellow", "Orange"))
mtext("Marital Status", side=1, line = 6)
text(x = xx, y = hoursPerRelStatusR+3, label=as.character(hoursPerRelStatusR))
```
Analysis: Based off the bar graph, people married work the most hours

## 7. Education | Does education affect wage?

```{r}
baG = length(df$education[df$education == " Bachelors" & df$wage_below_orAbove_50k == " >50K"])
baL = length(df$education[df$education == " Bachelors" & df$wage_below_orAbove_50k == " <=50K"])
scG = length(df$education[df$education == " Some-college" & df$wage_below_orAbove_50k == " >50K"])
scL = length(df$education[df$education == " Some-college" & df$wage_below_orAbove_50k == " <=50K"])
eG = length(df$education[df$education == " 11th" & df$wage_below_orAbove_50k == " >50K"])
eL = length(df$education[df$education == " 11th" & df$wage_below_orAbove_50k == " <=50K"])
hsG = length(df$education[df$education == " HS-grad" & df$wage_below_orAbove_50k == " >50K"])
hsL = length(df$education[df$education == " HS-grad" & df$wage_below_orAbove_50k == " <=50K"])
psG = length(df$education[df$education == " Prof-school" & df$wage_below_orAbove_50k == " >50K"])
psL = length(df$education[df$education == " Prof-school" & df$wage_below_orAbove_50k == " <=50K"])
aaG = length(df$education[df$education == " Assoc-acdm" & df$wage_below_orAbove_50k == " >50K"])
aaL = length(df$education[df$education == " Assoc-acdm" & df$wage_below_orAbove_50k == " <=50K"])
avG = length(df$education[df$education == " Assoc-voc" & df$wage_below_orAbove_50k == " >50K"])
avL = length(df$education[df$education == " Assoc-voc" & df$wage_below_orAbove_50k == " <=50K"])
nineG = length(df$education[df$education == " 9th" & df$wage_below_orAbove_50k == " >50K"])
nineL = length(df$education[df$education == " 9th" & df$wage_below_orAbove_50k == " <=50K"])
sandeG = length(df$education[df$education == " 7th-8th" & df$wage_below_orAbove_50k == " >50K"])
sandeL = length(df$education[df$education == " 7th-8th" & df$wage_below_orAbove_50k == " <=50K"])
twG = length(df$education[df$education == " 12th" & df$wage_below_orAbove_50k == " >50K"])
twL = length(df$education[df$education == " 12th" & df$wage_below_orAbove_50k == " <=50K"])
maG = length(df$education[df$education == " Masters" & df$wage_below_orAbove_50k == " >50K"])
maL = length(df$education[df$education == " Masters" & df$wage_below_orAbove_50k == " <=50K"])
oneandfourG = length(df$education[df$education == " 1st-4th" & df$wage_below_orAbove_50k == " >50K"])
oneandfourL = length(df$education[df$education == " 1st-4th" & df$wage_below_orAbove_50k == " <=50K"])
tenG = length(df$education[df$education == " 10th" & df$wage_below_orAbove_50k == " >50K"])
tenL = length(df$education[df$education == " 10th" & df$wage_below_orAbove_50k == " <=50K"])
docG = length(df$education[df$education == " Doctorate" & df$wage_below_orAbove_50k == " >50K"])
docL = length(df$education[df$education == " Doctorate" & df$wage_below_orAbove_50k == " <=50K"])
ftsG = length(df$education[df$education == " 5th-6th" & df$wage_below_orAbove_50k == " >50K"])
ftsL = length(df$education[df$education == " 5th-6th" & df$wage_below_orAbove_50k == " <=50K"])
preG = length(df$education[df$education == " Preschool" & df$wage_below_orAbove_50k == " >50K"])
preL = length(df$education[df$education == " Preschool" & df$wage_below_orAbove_50k == " <=50K"])

edu <- as.table(rbind(c(baG, scG, eG, hsG, psG, aaG, avG, nineG, sandeG, twG, maG, oneandfourG, tenG, docG, ftsG, preG), c(baL, scL, eL, hsL, psL, aaL, avL, nineL, sandeL, twL, maL, oneandfourL, tenL, docL, ftsL, preL)))

par(mar = c(8, 4, 1, 1))
aa <- barplot(edu, main = "Education's Influence on Wage", xlab = "", ylab = "Number of People", ylim = c(0, 10000), col = c("pink", "purple"), names.arg = c("Bachelors", "Some-college", "11th", "HS-grad", "Prof-school", "Assoc-acdm", "Assoc-voc", "9th", "7th-8th", "12th", "Masters", "1st-4th", "10th", "Doctorate", "5th-6th", "Preschool"), beside = TRUE, las = 2)
legend("topright", legend = c("Wage is Above 50K", "Wage is Below 50k"), fill = c("pink", "purple"))
mtext("Education", side=1, line = 5)
text(x = aa, y = edu+200, label=as.character(edu), cex = 0.5)
```

## 8. Occupation | Hours per Week by Occupation

```{r}
par(mar = c(10, 4, 1, 1))
boxplot(df$`hours-per-week`~df$occupation, mian = "Hours Worked per Week by Workclass", xlab = " ", ylab = "Hours Worked per Week", col = "darkolivegreen3", names = c("Not Given", "Adm-clerical", "Armed-Forces", "Craft\nrepair", "Exec-managerial", "Farming-fishing", "Handlers-cleaners", "Machine-op-inspct", "Other\nservice", "Priv-house-serv", "Prof-specialty", "Protective-serv", "Sales", "Tech\nsupport", "Transport-moving"), las = 2)
mtext("Occupation", side=1, line = 8)
```

